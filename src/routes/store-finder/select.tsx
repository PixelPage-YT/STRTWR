import { A } from '@solidjs/router';
import Fuse from 'fuse.js';
import { createSignal, For } from 'solid-js';
import config from '../../../config';

/**
 * Store-Finder Page
 * @returns JSX element
 */
const StoreFinder = () => {
    const [getSearchResults, setSearchResults] = createSignal<any[]>();

    const fuse = new Fuse(config.stores, {
        keys: ['cityname'],
        includeScore: true,
    });

    return (
        <>
            <div class="grid place-items-center">
                <svg
                    width="290"
                    height="210"
                    viewBox="0 0 290 210"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M64.98 74.4173C62.21 74.4173 59.18 73.7373 56.2 73.0673C53.99 72.5673 52.04 72.4473 50.47 72.3473C48.1 72.1973 46.22 72.0773 45.18 70.6873C44.15 69.3173 44.15 66.9873 45.18 62.3873C46.55 56.2773 49.6 46.5273 53.34 38.5073C58.16 28.1573 62.8 23.3973 67.12 24.3673C72.91 25.6673 75.22 35.3273 76.08 40.9773C77.28 48.8573 77.18 58.2173 75.82 64.2673C74.02 72.2873 69.89 74.4073 64.98 74.4073V74.4173ZM66.04 26.0473C62.86 26.0473 58.96 30.6873 54.97 39.2773C51.29 47.1773 48.28 56.7773 46.94 62.7973C46.07 66.6573 45.98 68.7673 46.63 69.6273C47.18 70.3573 48.61 70.4473 50.6 70.5673C52.23 70.6673 54.25 70.7973 56.6 71.3273C65.93 73.4173 71.77 74.1773 74.08 63.8873C76.55 52.8573 74.67 27.9073 66.74 26.1273C66.51 26.0773 66.28 26.0473 66.05 26.0473H66.04Z"
                        fill="#DFDFE0"
                    />
                    <path
                        d="M102.74 148.557L13.82 149.137L0 142.787L8.04999 60.6773L16.15 61.0873L99.46 65.3273L102.74 148.557Z"
                        fill="#E2E3E4"
                    />
                    <path
                        opacity="0.2"
                        d="M13.82 149.137L0 142.787L8.04999 60.6773L16.15 61.0873L13.82 149.137Z"
                        fill="#272223"
                    />
                    <path
                        d="M226.5 84.1473C221.85 84.1473 216.78 83.0073 211.77 81.8873C208.06 81.0573 204.79 80.8473 202.17 80.6873C198.19 80.4373 195.04 80.2373 193.29 77.9073C191.56 75.6073 191.56 71.6973 193.29 63.9873C195.59 53.7473 200.71 37.3873 206.97 23.9273C215.06 6.56731 222.83 -1.42271 230.08 0.207291C239.79 2.38729 243.66 18.5973 245.11 28.0573C247.13 41.2673 246.95 56.9673 244.67 67.1273C241.65 80.5773 234.72 84.1373 226.49 84.1373L226.5 84.1473ZM228.27 3.0173C222.94 3.0173 216.4 10.7973 209.7 25.1973C203.53 38.4473 198.49 54.5573 196.22 64.6473C194.77 71.1273 194.61 74.6573 195.69 76.1073C196.61 77.3273 199.02 77.4873 202.35 77.6873C205.08 77.8573 208.48 78.0673 212.42 78.9573C228.08 82.4673 237.87 83.7473 241.74 66.4773C245.89 47.9773 242.73 6.1273 229.42 3.1373C229.04 3.0473 228.65 3.00729 228.26 3.00729L228.27 3.0173Z"
                        fill="#DFDFE0"
                    />
                    <path
                        d="M289.83 208.497L140.68 209.477L117.51 198.817L131.01 61.1073L144.59 61.7973L284.32 68.9073L289.83 208.497Z"
                        fill="#0EA5E9"
                    />
                    <path
                        opacity="0.2"
                        d="M140.68 209.477L117.51 198.817L131.01 61.1073L144.59 61.7973L140.68 209.477Z"
                        fill="#272223"
                    />
                    <path
                        d="M228.75 58.7473C225.98 58.7473 222.95 58.0673 219.97 57.3973C217.76 56.8973 215.81 56.7773 214.24 56.6773C211.87 56.5273 209.99 56.4073 208.95 55.0173C207.92 53.6473 207.92 51.3173 208.95 46.7173C210.32 40.6073 213.37 30.8573 217.11 22.8373C221.93 12.4873 226.57 7.72731 230.89 8.69731C236.68 9.99731 238.99 19.6573 239.85 25.3073C241.05 33.1873 240.95 42.5473 239.59 48.5973C237.79 56.6173 233.66 58.7373 228.75 58.7373V58.7473ZM229.81 10.3773C226.63 10.3773 222.73 15.0173 218.74 23.6073C215.06 31.5073 212.05 41.1073 210.71 47.1273C209.84 50.9873 209.75 53.0973 210.4 53.9573C210.95 54.6873 212.38 54.7773 214.37 54.8973C216 54.9973 218.02 55.1273 220.37 55.6573C229.7 57.7473 235.54 58.5073 237.85 48.2173C240.32 37.1873 238.44 12.2373 230.51 10.4573C230.28 10.4073 230.05 10.3773 229.82 10.3773H229.81Z"
                        fill="#DFDFE0"
                    />
                    <path
                        d="M266.5 132.897L177.58 133.477L163.76 127.127L171.81 45.0173L179.91 45.4273L263.22 49.6673L266.5 132.897Z"
                        fill="#E2E3E4"
                    />
                    <path
                        opacity="0.2"
                        d="M177.58 133.477L163.76 127.127L171.81 45.0173L179.91 45.4273L177.58 133.477Z"
                        fill="#272223"
                    />
                </svg>
                <h1 class="text-4xl mt-5 font-heading font-medium">
                    Find the best stores
                </h1>
                <p class="mt-3 w-80 lg:w-96 text-center">
                    Find the coolest local skate shops and streetwear stores in
                    your town with our directory. Supporting local businesses
                    helps build a vibrant community, creates jobs, and
                    contributes to the local economy. Shop small, shop local,
                    and keep your neighborhood thriving!
                </p>
                <input
                    class="mt-3 bg-[#E2E3E4] rounded-lg p-1.5 outline-none placeholder:text-[#FFFFFF]"
                    onInput={(e) => {
                        setSearchResults(
                            fuse.search(e.currentTarget.value, { limit: 5 })
                        );
                    }}
                    placeholder="Start typing..."
                />
                <div class="my-5">
                    <For each={getSearchResults()}>
                        {(result) =>
                            result.score < 0.5 && (
                                <A href={'/store-finder/' + result.item.idname}>
                                    <div class="">
                                        <h1 class="text-center">
                                            {result.item.cityname}
                                        </h1>
                                    </div>
                                </A>
                            )
                        }
                    </For>
                </div>
            </div>
            <p class="text-slate-100 mb-5 text-center">
                We are not affiliated with any stores displayed above.
            </p>
        </>
    );
};

export default StoreFinder;
